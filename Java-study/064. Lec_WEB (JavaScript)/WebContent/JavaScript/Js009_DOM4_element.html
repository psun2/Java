<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DOM - Node (append, remove)</title>
    <style>
      div {
        padding: 3px;
      }
      p {
        background-color: cyan;
      }
      table,
      th,
      td {
        border: 1px solid black;
        border-collapse: collapse;
        padding: 5px;
      }
      td {
        background-color: orange;
      }

      span,
      input {
        display: inline-block;
        width: 200px;
      }
    </style>
  </head>
  <!-- 
	node 를 생성할수 있다.!
	생성된 노드를 원하는 node 에 붙일수 있다.!
	
	document.createElement()
	document.createTextNode()
	
	E.appendChild(A) : 
		A를 E의 마지막 child 로 append 된다.
	E.insertBefore(A, B) : 
		E 의 child 중에  B 앞에 A를 child 로 insert 한다.
	E.removeChild(A) :
		E 의 child 중에 A 를 제거한다.
 -->

  <!-- 
 	attribute 를 세팅할수도 있다
 	E.setAttribute("attribute 이름", "attribute 값");
 	
 	attribute 를 제거
 	E.removeAttribute("attribute 이름");
 	
 	attribute 값 리턴
 	E.getAttribute("attribute 이름");  
 	
 	attribute 를 갖고 있는지 여부, true/false 리턴
 	E.hasAttribute("attribute 이름");   
  -->
  <body>
    <h1>DOM - Node (append, remove)</h1>

    <div id="div1" style="background-color: yellow">
      div1입니다
      <p id="p1">p1 입니다</p>
      <p id="p2">p2 입니다</p>
    </div>
    <script>
      let para;
      let node;
      let parent, child;
      let element = document.getElementById('div1');

      // 단계별로 확인해보자

      // appendChild()
      // TODO:
      para = document.createElement('p'); // <p> element node 생성
      para.setAttribute('id', 'p3'); // attribute 추가
      node = document.createTextNode('appendChild() 로 추가');
      para.appendChild(node);
      element.appendChild(para);

      // prepend()
      // TODO:
      para = document.createElement('p'); // <p> element node 생성
      node = document.createTextNode('prepend() 로 추가');
      para.appendChild(node);
      document.getElementById('p3').prepend(para);

      // insertBefore()
      // TODO:
      para = document.createElement('p'); // <p> element node 생성
      node = document.createTextNode('insertBefore() 로 추가');
      para.appendChild(node);
      child = document.getElementById('p1');
      element.insertBefore(para, child);

      // removeChild()
      // TODO:
      parent = document.getElementById('div1');
      child = document.getElementById('p2');
      parent.removeChild(child);
    </script>

    <div>
      <table id="table1">
        <tr>
          <th>이름</th>
          <th>아이디</th>
        </tr>
        <tr>
          <td>
            <!-- this 는 그 element다 -->
            <span onclick="doChange(this);"> 홍길동 </span>
          </td>
          <td>
            <span onclick="doChange(this);"> Mr.Hong </span>
          </td>
        </tr>
      </table>
    </div>
    <script>
      // TODO:
      // style 를 삽입하는 3가지 방법 property attribute
      // document.getElementById('table1').style.border = '4px dashed red';
      // document.getElementById('table1').style.setProperty('border', '4px dashed red');
      document
        .getElementById('table1')
        .setAttribute('style', 'border:4px dashed red');

      const doEnter = (element) => {
        if (window.event.keyCode === 13) doChange(element);
      };

      const doChange = (element) => {
        console.log(element.nodeName);
        const nodeName = element.nodeName.toLowerCase();
        const parentElement = element.parentElement;
        const parentNode = element.parentNode;

        if (nodeName === 'span') {
          const text = element.innerText.trim();
          parentElement.removeChild(element);
          const input = document.createElement('input');
          input.setAttribute('value', text);

          input.addEventListener('focusout', () => {
            // input === this
            // arrow function 은 binding이 되지 않습니다.
            // 그러므로 this 사용 불가
            doChange(input);
          });

          input.addEventListener('keyup', function () {
            console.log(this);
            doEnter(this);
          });

          parentElement.appendChild(input);
          input.focus();
        } else if (nodeName === 'input') {
          const text = element.value;
          parentElement.removeChild(element);
          const span = document.createElement('span');
          var textNode = document.createTextNode(text);
          span.appendChild(textNode);

          span.addEventListener('click', () => {
            doChange(span);
          });

          parentElement.appendChild(span);
        }
      };
    </script>
    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  </body>
</html>
